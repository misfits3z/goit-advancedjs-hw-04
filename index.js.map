{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import iziToast from \"izitoast\";\n// Додатковий імпорт стилів\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport axios from \"axios\";\n\naxios.defaults.baseURL = 'https://pixabay.com/api/'\nconst API_KEY = '46457503-330abda4e6a20c9fb19d2e08a';\n\nlet page = 1;\n\nasync function getPhotos(query, resetPage = false) {\n    if (resetPage) {\n        page = 1;\n    }\n\n    try {\n        const response = await axios('', {\n            params: {\n                key: API_KEY, \n                q: query,        \n                page: page,      \n                per_page: 200,    \n            }\n        });\n\n        const data = response.data\n\n    \n        if (data.totalHits > 0) {\n            page += 1; \n            return data.hits; \n        } else {\n            iziToast.error({\n                message: `Sorry, there are no images matching your search query. Please try again!`,\n                position: \"topRight\",\n                timeout: 2000,\n                color: \"#FF0000\",\n                messageColor: \"#FFFFFF\",\n            });\n            return []; \n        }\n    } catch (err) {\n        console.log(err);\n        \n        return []; \n        \n    }\n}\n \n// const BASE_URL = 'https://pixabay.com/api/' ;\n// const API_KEY = '46457503-330abda4e6a20c9fb19d2e08a';\n\n// function getPhotos(query){\n\n//     return fetch(`${BASE_URL}?key=${API_KEY}&q=${query}&image_type=photo&orientation=horizontal&safesearch=true`).then((response) => {\n//         if (!response.ok) {\n//           throw new Error(response.status);\n//         }\n//         return response.json();\n//       }).then( data => {\n//         if (data.totalHits > 0) {\n//           return data.hits;\n//         } else {\n        //   iziToast.error({\n        //     message: `Sorry, there are no images matching your search query. Please try again!`,\n        //     position: \"topRight\", \n        //     timeout: 2000,\n        //     color: \"#FF0000\",\n        //     messageColor: \"#FFFFFF\", \n        //   }); \n//         }\n//     })    \n    \n// }\n\nexport{getPhotos};","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css'; \n\n\nconst createGalleryItems = (cards) => {\n    return cards.map(({ largeImageURL, webformatURL, tags, likes, views, comments, downloads }) => \n      `<li class=\"gallery-item\">\n        <a class=\"gallery-link\" href=\"${largeImageURL}\">\n          <img\n            class=\"gallery-image\"\n            src=\"${webformatURL}\"\n            alt=\"${tags}\"\n          />\n        </a>\n        <div class=\"gallery-info\">\n          <p><b>Likes:</b> ${likes}</p>\n          <p><b>Views:</b> ${views}</p>\n          <p><b>Comments:</b> ${comments}</p>\n          <p><b>Downloads:</b> ${downloads}</p>\n        </div>\n      </li>`\n    ).join('');\n  };\n  \n  \n  \n  const initLightbox = () => {\n    const lightbox = new SimpleLightbox('.gallery .gallery-item a', {\n      captions: true,\n      captionsData: 'alt',\n      captionDelay: 250,\n      animationSpeed: 300,\n    });\n    \n    lightbox.refresh();\n  };\n  \n\nexport default createGalleryItems;\nexport { createGalleryItems, initLightbox };","// 46457503-330abda4e6a20c9fb19d2e08a\n// https://pixabay.com/api/\nimport { getPhotos } from \"./js/pixabay-api\";\nimport {createGalleryItems, initLightbox} from \"./js/render-functions\";\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\n\nconst searchFormEl = document.querySelector('.js-search-form');\nconst galleryEl = document.querySelector('.js-gallery');\nconst loadMore = document.querySelector('.btn')\nconst loader = document.querySelector('.loader');\n\nlet userQuery = '';\nlet page = 1;\nlet totalHits = 0; \nlet totalLoadedImages = 0;\n\nloadMore.style.display = 'none';\n\n// getPhotos('flowers').then(console.log).catch(console.error);\n\nsearchFormEl.addEventListener(\"submit\", handleSearch)\n\n\nasync function handleSearch(event){\n    event.preventDefault();\n\n\nuserQuery = event.currentTarget.elements.user_query.value.trim();\n\ngalleryEl.innerHTML = '';\n\n\nloader.style.display = 'block';\n\nloadMore.style.display = 'none';\n\npage = 1;\ntotalLoadedImages = 0;\n\ntry{\n   const data = await getPhotos(userQuery, true);\n\n   if (data.length > 0){\n    totalHits = data.totalHits;\n    totalLoadedImages += data.length;\n\n\n    const galleryMarkup = createGalleryItems(data);\n    galleryEl.insertAdjacentHTML('beforeend', galleryMarkup); \n\n    initLightbox();\n    loadMore.style.display = 'block';\n\n   }\n\n} catch(err){\n    console.log(err);\n} finally {\n        loader.style.display = 'none';\n        searchFormEl.reset();\n    }\n};\n\n\nloadMore.addEventListener('click', handleLoad);\n\nasync function handleLoad() {\n    loader.style.display = 'block'; \n\n    try {\n        page += 1;\n        const data = await getPhotos(userQuery, false);\n\n        if (data.length > 0) {\n            totalLoadedImages += data.length;\n\n\n            const galleryMarkup = createGalleryItems(data);\n            galleryEl.insertAdjacentHTML('beforeend', galleryMarkup);\n            \n            initLightbox();\n        }\n        if (totalLoadedImages >= totalHits){\n            loadMore.style.display = 'none'\n            iziToast.error({\n                message: `We're sorry, but you've reached the end of search results`,\n                position: \"topRight\",\n                timeout: 2000,\n                color: \"lightblue\",\n                messageColor: \"#FFFFFF\",\n            });\n        }\n    } catch (err) {\n        console.log(err);\n    } finally {\n        loader.style.display = 'none'; \n    }\n}\n\n\n\n// galleryEl.innerHTML = '';\n\n// const loader = document.querySelector('.loader');\n// loader.style.display = 'block';\n\n// getPhotos(userQuery).then(data => {\n//     // console.log(data.hits); \n//     const galleryMarkup = createGalleryItems(data);\n//     galleryEl.insertAdjacentHTML('beforeend', galleryMarkup); \n\n//     initLightbox();\n//   })\n//   .catch(console.error)\n//   .finally(() => {\n//     loader.style.display = 'none';\n//     form.reset();\n// });\n// }"],"names":["axios","API_KEY","page","getPhotos","query","resetPage","data","iziToast","err","createGalleryItems","cards","largeImageURL","webformatURL","tags","likes","views","comments","downloads","initLightbox","SimpleLightbox","searchFormEl","galleryEl","loadMore","loader","userQuery","totalHits","totalLoadedImages","handleSearch","event","galleryMarkup","handleLoad"],"mappings":"owBAKAA,EAAM,SAAS,QAAU,2BACzB,MAAMC,EAAU,qCAEhB,IAAIC,EAAO,EAEX,eAAeC,EAAUC,EAAOC,EAAY,GAAO,CAC3CA,IACAH,EAAO,GAGX,GAAI,CAUA,MAAMI,GATW,MAAMN,EAAM,GAAI,CAC7B,OAAQ,CACJ,IAAKC,EACL,EAAGG,EACH,KAAMF,EACN,SAAU,GACb,CACb,CAAS,GAEqB,KAGtB,OAAII,EAAK,UAAY,GACjBJ,GAAQ,EACDI,EAAK,OAEZC,EAAS,MAAM,CACX,QAAS,2EACT,SAAU,WACV,QAAS,IACT,MAAO,UACP,aAAc,SAC9B,CAAa,EACM,GAEd,OAAQC,EAAK,CACV,eAAQ,IAAIA,CAAG,EAER,EAEV,CACL,CC3CA,MAAMC,EAAsBC,GACjBA,EAAM,IAAI,CAAC,CAAE,cAAAC,EAAe,aAAAC,EAAc,KAAAC,EAAM,MAAAC,EAAO,MAAAC,EAAO,SAAAC,EAAU,UAAAC,CAAW,IACxF;AAAA,wCACkCN,CAAa;AAAA;AAAA;AAAA,mBAGlCC,CAAY;AAAA,mBACZC,CAAI;AAAA;AAAA;AAAA;AAAA,6BAIMC,CAAK;AAAA,6BACLC,CAAK;AAAA,gCACFC,CAAQ;AAAA,iCACPC,CAAS;AAAA;AAAA,YAG1C,EAAM,KAAK,EAAE,EAKLC,EAAe,IAAM,CACR,IAAIC,EAAe,2BAA4B,CAC9D,SAAU,GACV,aAAc,MACd,aAAc,IACd,eAAgB,GACtB,CAAK,EAEQ,QAAO,CACjB,EC3BGC,EAAe,SAAS,cAAc,iBAAiB,EACvDC,EAAY,SAAS,cAAc,aAAa,EAChDC,EAAW,SAAS,cAAc,MAAM,EACxCC,EAAS,SAAS,cAAc,SAAS,EAE/C,IAAIC,EAAY,GACZtB,EAAO,EACPuB,EAAY,EACZC,EAAoB,EAExBJ,EAAS,MAAM,QAAU,OAIzBF,EAAa,iBAAiB,SAAUO,CAAY,EAGpD,eAAeA,EAAaC,EAAM,CAC9BA,EAAM,eAAc,EAGxBJ,EAAYI,EAAM,cAAc,SAAS,WAAW,MAAM,OAE1DP,EAAU,UAAY,GAGtBE,EAAO,MAAM,QAAU,QAEvBD,EAAS,MAAM,QAAU,OAEzBpB,EAAO,EACPwB,EAAoB,EAEpB,GAAG,CACA,MAAMpB,EAAO,MAAMH,EAAUqB,EAAW,EAAI,EAE5C,GAAIlB,EAAK,OAAS,EAAE,CACnBmB,EAAYnB,EAAK,UACjBoB,GAAqBpB,EAAK,OAG1B,MAAMuB,EAAgBpB,EAAmBH,CAAI,EAC7Ce,EAAU,mBAAmB,YAAaQ,CAAa,EAEvDX,IACAI,EAAS,MAAM,QAAU,OAEzB,CAEJ,OAAQd,EAAI,CACR,QAAQ,IAAIA,CAAG,CACnB,QAAU,CACFe,EAAO,MAAM,QAAU,OACvBH,EAAa,MAAK,CACrB,CACL,CAGAE,EAAS,iBAAiB,QAASQ,CAAU,EAE7C,eAAeA,GAAa,CACxBP,EAAO,MAAM,QAAU,QAEvB,GAAI,CACArB,GAAQ,EACR,MAAMI,EAAO,MAAMH,EAAUqB,EAAW,EAAK,EAE7C,GAAIlB,EAAK,OAAS,EAAG,CACjBoB,GAAqBpB,EAAK,OAG1B,MAAMuB,EAAgBpB,EAAmBH,CAAI,EAC7Ce,EAAU,mBAAmB,YAAaQ,CAAa,EAEvDX,GACH,CACGQ,GAAqBD,IACrBH,EAAS,MAAM,QAAU,OACzBf,EAAS,MAAM,CACX,QAAS,4DACT,SAAU,WACV,QAAS,IACT,MAAO,YACP,aAAc,SAC9B,CAAa,EAER,OAAQC,EAAK,CACV,QAAQ,IAAIA,CAAG,CACvB,QAAc,CACNe,EAAO,MAAM,QAAU,MAC1B,CACL"}